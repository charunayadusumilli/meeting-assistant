{"version":3,"file":"sdk.js","sources":["../../src/renderer/sdk.ts"],"sourcesContent":["/* eslint-disable deprecation/deprecation */\n/* eslint-disable no-restricted-globals */\nimport {\n  BrowserOptions,\n  getDefaultIntegrations as getDefaultBrowserIntegrations,\n  init as browserInit,\n} from '@sentry/browser';\nimport { debug, Integration } from '@sentry/core';\nimport { scopeToMainIntegration } from './integrations/scope-to-main.js';\nimport { electronRendererStackParser } from './stack-parse.js';\nimport { makeRendererTransport } from './transport.js';\n\n/** Get the default integrations for the renderer SDK. */\nexport function getDefaultIntegrations(options: ElectronRendererOptions): Integration[] {\n  return [\n    ...getDefaultBrowserIntegrations(options).filter((i) => i.name !== 'BrowserSession'),\n    scopeToMainIntegration(),\n  ];\n}\n\nexport interface ElectronRendererOptionsInternal extends Omit<BrowserOptions, 'dsn' | 'environment' | 'release'> {\n  /** @deprecated `dsn` should only be passed to the main process `Sentry.init` call */\n  dsn?: string;\n  /** @deprecated `release` should only be passed to the main process `Sentry.init` call */\n  release?: string;\n  /** @deprecated `environment` should only be passed to the main process `Sentry.init` call */\n  environment?: string;\n\n  /**\n   * Custom namespace for IPC channels and protocol routes.\n   *\n   * Valid characters are a-z, 0-9, hyphen (-).\n   * Should match `ipcNamespace` passed in the main process.\n   *\n   * @default \"sentry-ipc\"\n   */\n  ipcNamespace: string;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\ninterface ElectronRendererOptions extends Partial<ElectronRendererOptionsInternal> {\n  //\n}\n\n/**\n * Initialize Sentry in the Electron renderer process\n * @param options SDK options\n * @param originalInit Optional init function for a specific framework SDK\n * @returns\n */\nexport function init<O extends ElectronRendererOptions>(\n  options: ElectronRendererOptions & O = {} as ElectronRendererOptions & O,\n  // This parameter name ensures that TypeScript error messages contain a hint for fixing SDK version mismatches\n  originalInit: (if_you_get_a_typescript_error_ensure_sdks_use_version_v10_17_0: O) => void = browserInit,\n): void {\n  // Ensure the browser SDK is only init'ed once.\n  if (window?.__SENTRY__RENDERER_INIT__) {\n    debug.warn(`The browser SDK has already been initialized.\nIf init has been called in the preload and contextIsolation is disabled, is not required to call init in the renderer`);\n    return;\n  }\n\n  window.__SENTRY__RENDERER_INIT__ = true;\n\n  // Disable client reports for renderer as the sdk should only send\n  // events using the main process.\n  options.sendClientReports = false;\n\n  if (options.defaultIntegrations === undefined) {\n    options.defaultIntegrations = getDefaultIntegrations(options);\n  }\n\n  if (options.stackParser === undefined) {\n    options.stackParser = electronRendererStackParser;\n  }\n\n  if (options.ipcNamespace === undefined) {\n    options.ipcNamespace = 'sentry-ipc';\n  }\n\n  // eslint-disable-next-line deprecation/deprecation\n  if (options.dsn === undefined) {\n    // Events are sent via the main process but browser SDK wont start without dsn\n    // eslint-disable-next-line deprecation/deprecation\n    options.dsn = 'https://12345@dummy.dsn/12345';\n  }\n\n  if (options.transport === undefined) {\n    options.transport = makeRendererTransport;\n  }\n\n  // We only handle initialScope in the main process otherwise it can cause race conditions over IPC\n  delete options.initialScope;\n\n  originalInit(options);\n}\n"],"names":["getDefaultBrowserIntegrations","browserInit"],"mappings":";;;;;;AAAA;AACA;AAWA;AACM,SAAU,sBAAsB,CAAC,OAAgC,EAAA;IACrE,OAAO;AACL,QAAA,GAAGA,wBAA6B,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,gBAAgB,CAAC;AACpF,QAAA,sBAAsB,EAAE;KACzB;AACH;AA0BA;;;;;AAKG;AACG,SAAU,IAAI,CAClB,OAAA,GAAuC,EAAiC;AACxE;AACA,YAAA,GAA4FC,MAAW,EAAA;;IAGvG,IAAI,MAAM,EAAE,yBAAyB,EAAE;QACrC,KAAK,CAAC,IAAI,CAAC,CAAA;AACuG,qHAAA,CAAA,CAAC;QACnH;AACD,IAAA;AAED,IAAA,MAAM,CAAC,yBAAyB,GAAG,IAAI;;;AAIvC,IAAA,OAAO,CAAC,iBAAiB,GAAG,KAAK;AAEjC,IAAA,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;AAC7C,QAAA,OAAO,CAAC,mBAAmB,GAAG,sBAAsB,CAAC,OAAO,CAAC;AAC9D,IAAA;AAED,IAAA,IAAI,OAAO,CAAC,WAAW,KAAK,SAAS,EAAE;AACrC,QAAA,OAAO,CAAC,WAAW,GAAG,2BAA2B;AAClD,IAAA;AAED,IAAA,IAAI,OAAO,CAAC,YAAY,KAAK,SAAS,EAAE;AACtC,QAAA,OAAO,CAAC,YAAY,GAAG,YAAY;AACpC,IAAA;;AAGD,IAAA,IAAI,OAAO,CAAC,GAAG,KAAK,SAAS,EAAE;;;AAG7B,QAAA,OAAO,CAAC,GAAG,GAAG,+BAA+B;AAC9C,IAAA;AAED,IAAA,IAAI,OAAO,CAAC,SAAS,KAAK,SAAS,EAAE;AACnC,QAAA,OAAO,CAAC,SAAS,GAAG,qBAAqB;AAC1C,IAAA;;IAGD,OAAO,OAAO,CAAC,YAAY;IAE3B,YAAY,CAAC,OAAO,CAAC;AACvB;;;;"}