{"version":3,"file":"merge.js","sources":["../src/src/main/merge.ts"],"sourcesContent":["import { Event } from '@sentry/core';\n\n/** Removes private properties from event before merging */\nfunction removePrivateProperties(event: Event): void {\n  // These contain recursive structures and are not meant to be serialized\n  delete event.sdkProcessingMetadata?.capturedSpanScope;\n  delete event.sdkProcessingMetadata?.capturedSpanIsolationScope;\n\n  for (const span of event.spans || []) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    delete (span as any).spanRecorder;\n  }\n}\n\n/** Merges Events with defaults */\nexport function mergeEvents(defaults: Event, event: Event): Event {\n  removePrivateProperties(event);\n\n  const newEvent: Event = {\n    ...defaults,\n    ...event,\n    contexts: {\n      ...defaults.contexts,\n      ...event.contexts,\n      app: {\n        ...defaults.contexts?.app,\n        ...event.contexts?.app,\n      },\n      device: {\n        ...defaults.contexts?.device,\n        ...event.contexts?.device,\n      },\n    },\n    tags: {\n      ...defaults.tags,\n      ...event.tags,\n    },\n    sdk: {\n      ...defaults.sdk,\n      ...event.sdk,\n    },\n  };\n\n  if (defaults.extra || event.extra) {\n    newEvent.extra = {\n      ...defaults.extra,\n      ...event.extra,\n    };\n  }\n\n  return newEvent;\n}\n"],"names":[],"mappings":"AAEA;AACA,SAAS,uBAAuB,CAAC,KAAY,EAAA;;AAE3C,IAAA,OAAO,KAAK,CAAC,qBAAqB,EAAE,iBAAiB;AACrD,IAAA,OAAO,KAAK,CAAC,qBAAqB,EAAE,0BAA0B;IAE9D,KAAK,MAAM,IAAI,IAAI,KAAK,CAAC,KAAK,IAAI,EAAE,EAAE;;QAEpC,OAAQ,IAAY,CAAC,YAAY;AAClC,IAAA;AACH;AAEA;AACM,SAAU,WAAW,CAAC,QAAe,EAAE,KAAY,EAAA;IACvD,uBAAuB,CAAC,KAAK,CAAC;AAE9B,IAAA,MAAM,QAAQ,GAAU;AACtB,QAAA,GAAG,QAAQ;AACX,QAAA,GAAG,KAAK;AACR,QAAA,QAAQ,EAAE;YACR,GAAG,QAAQ,CAAC,QAAQ;YACpB,GAAG,KAAK,CAAC,QAAQ;AACjB,YAAA,GAAG,EAAE;AACH,gBAAA,GAAG,QAAQ,CAAC,QAAQ,EAAE,GAAG;AACzB,gBAAA,GAAG,KAAK,CAAC,QAAQ,EAAE,GAAG;AACvB,aAAA;AACD,YAAA,MAAM,EAAE;AACN,gBAAA,GAAG,QAAQ,CAAC,QAAQ,EAAE,MAAM;AAC5B,gBAAA,GAAG,KAAK,CAAC,QAAQ,EAAE,MAAM;AAC1B,aAAA;AACF,SAAA;AACD,QAAA,IAAI,EAAE;YACJ,GAAG,QAAQ,CAAC,IAAI;YAChB,GAAG,KAAK,CAAC,IAAI;AACd,SAAA;AACD,QAAA,GAAG,EAAE;YACH,GAAG,QAAQ,CAAC,GAAG;YACf,GAAG,KAAK,CAAC,GAAG;AACb,SAAA;KACF;AAED,IAAA,IAAI,QAAQ,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,EAAE;QACjC,QAAQ,CAAC,KAAK,GAAG;YACf,GAAG,QAAQ,CAAC,KAAK;YACjB,GAAG,KAAK,CAAC,KAAK;SACf;AACF,IAAA;AAED,IAAA,OAAO,QAAQ;AACjB;;;;"}