{"version":3,"file":"event-loop-block.js","sources":["../../src/src/renderer/integrations/event-loop-block.ts"],"sourcesContent":["import { defineIntegration } from '@sentry/core';\nimport { RendererProcessAnrOptions } from '../../common/ipc.js';\nimport { getIPC } from '../ipc.js';\n\ninterface Options {\n  /**\n   * The threshold in milliseconds for what constitutes an event loop block.\n   */\n  threshold: number;\n\n  /**\n   * @ignore To remove in next major version.\n   */\n  pollInterval?: number;\n\n  /**\n   * @ignore To remove in next major version.\n   */\n  captureStackTrace?: boolean;\n}\n\nexport const eventLoopBlockIntegration = defineIntegration((options?: Options) => {\n  const anrThreshold = options?.threshold ?? 1000;\n  const pollInterval = options?.pollInterval || anrThreshold / 2;\n\n  return {\n    name: 'EventLoopBlockRenderer',\n    setup(client) {\n      const config: RendererProcessAnrOptions = {\n        pollInterval,\n        anrThreshold,\n        captureStackTrace: true,\n        ...options,\n      };\n\n      const ipc = getIPC(client);\n\n      // eslint-disable-next-line no-restricted-globals\n      ipc.sendStatus({ status: document.visibilityState, config });\n\n      setInterval(() => {\n        ipc.sendStatus({ status: 'alive', config });\n      }, config.pollInterval);\n    },\n  };\n});\n"],"names":["defineIntegration","ipc","getIPC"],"mappings":";;;MAqBa,yBAAyB,GAAGA,sBAAiB,CAAC,CAAC,OAAiB,KAAI;AAC/E,IAAA,MAAM,YAAY,GAAG,OAAO,EAAE,SAAS,IAAI,IAAI;IAC/C,MAAM,YAAY,GAAG,OAAO,EAAE,YAAY,IAAI,YAAY,GAAG,CAAC;IAE9D,OAAO;AACL,QAAA,IAAI,EAAE,wBAAwB;AAC9B,QAAA,KAAK,CAAC,MAAM,EAAA;AACV,YAAA,MAAM,MAAM,GAA8B;gBACxC,YAAY;gBACZ,YAAY;AACZ,gBAAA,iBAAiB,EAAE,IAAI;AACvB,gBAAA,GAAG,OAAO;aACX;AAED,YAAA,MAAMC,KAAG,GAAGC,UAAM,CAAC,MAAM,CAAC;;AAG1B,YAAAD,KAAG,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,QAAQ,CAAC,eAAe,EAAE,MAAM,EAAE,CAAC;YAE5D,WAAW,CAAC,MAAK;gBACfA,KAAG,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,CAAC;AAC7C,YAAA,CAAC,EAAE,MAAM,CAAC,YAAY,CAAC;QACzB,CAAC;KACF;AACH,CAAC;;;;"}